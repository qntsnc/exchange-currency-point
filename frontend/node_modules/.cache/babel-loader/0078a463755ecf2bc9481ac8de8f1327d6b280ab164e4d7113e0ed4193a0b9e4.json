{"ast":null,"code":"import _objectSpread from\"/Users/qntsnc/GolandProjects/exchange-point/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import'./OperationsPage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const OperationsPage=()=>{const[operations,setOperations]=useState([]);const[clients,setClients]=useState([]);const[currencies,setCurrencies]=useState([]);const[newOperation,setNewOperation]=useState({client_id:'',operation_type:'CLIENT_SELLS_TO_EXCHANGE',currency_id:'',amount:''});const[loading,setLoading]=useState(false);const[formLoading,setFormLoading]=useState(false);const[error,setError]=useState(null);const[formError,setFormError]=useState('');const[currentPage,setCurrentPage]=useState(1);const pageSize=10;// Загружаем лимиты из localStorage или используем значения по умолчанию\nconst[operationLimits,setOperationLimits]=useState(()=>{const saved=localStorage.getItem('operationLimits');if(saved){try{var _parsed$find,_parsed$find2;const parsed=JSON.parse(saved);return{daily_currency_volume:((_parsed$find=parsed.find(l=>l.limit_name==='daily_currency_volume'))===null||_parsed$find===void 0?void 0:_parsed$find.limit_value)||'5000.0',single_operation_amount:((_parsed$find2=parsed.find(l=>l.limit_name==='single_operation_amount'))===null||_parsed$find2===void 0?void 0:_parsed$find2.limit_value)||'1000.0'};}catch(e){console.error('Error parsing operationLimits from localStorage:',e);}}return{daily_currency_volume:'5000.0',single_operation_amount:'1000.0'};});const fetchOperations=useCallback(async page=>{setLoading(true);setError(null);try{const response=await fetch(\"http://localhost:8080/api/v1/operations?page=\".concat(page,\"&pageSize=\").concat(pageSize));if(!response.ok){const errData=await response.json();throw new Error(errData.message||\"Failed to fetch operations (\".concat(response.status,\")\"));}const data=await response.json();setOperations(data.data||[]);}catch(err){setError('Ошибка загрузки операций: '+err.message);console.error('Fetch operations error:',err);setOperations([]);}finally{setLoading(false);}},[pageSize]);const downloadReceipt=async operationId=>{try{const response=await fetch(\"http://localhost:8080/api/v1/operations/\".concat(operationId,\"/receipt\"));if(!response.ok){throw new Error(\"Failed to download receipt (\".concat(response.status,\")\"));}const blob=await response.blob();const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=\"receipt_\".concat(operationId,\".pdf\");document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(url);}catch(err){console.error('Error downloading receipt:',err);setError(prev=>prev?\"\".concat(prev,\"; \\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043A\\u0430\\u0447\\u0438\\u0432\\u0430\\u043D\\u0438\\u044F \\u0447\\u0435\\u043A\\u0430: \").concat(err.message):\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0441\\u043A\\u0430\\u0447\\u0438\\u0432\\u0430\\u043D\\u0438\\u044F \\u0447\\u0435\\u043A\\u0430: \".concat(err.message));}};const openReceipt=reference=>{const receiptUrl=\"http://localhost:8080/api/v1/receipts/\".concat(reference);window.open(receiptUrl,'_blank');};const fetchDropdownData=useCallback(async()=>{try{var _clientsData$data,_currenciesData$data;const[clientsRes,currenciesRes]=await Promise.all([fetch('http://localhost:8080/api/v1/clients'),fetch('http://localhost:8080/api/v1/currencies')]);if(!clientsRes.ok)throw new Error('Failed to fetch clients for dropdown');const clientsData=await clientsRes.json();setClients(clientsData.data||[]);if(((_clientsData$data=clientsData.data)===null||_clientsData$data===void 0?void 0:_clientsData$data.length)>0&&!newOperation.client_id){setNewOperation(prev=>_objectSpread(_objectSpread({},prev),{},{client_id:clientsData.data[0].id.toString()}));}if(!currenciesRes.ok)throw new Error('Failed to fetch currencies for dropdown');const currenciesData=await currenciesRes.json();setCurrencies(currenciesData.data||[]);if(((_currenciesData$data=currenciesData.data)===null||_currenciesData$data===void 0?void 0:_currenciesData$data.length)>0&&!newOperation.currency_id){setNewOperation(prev=>_objectSpread(_objectSpread({},prev),{},{currency_id:currenciesData.data[0].id.toString()}));}}catch(err){setError(prev=>prev?\"\".concat(prev,\"; \\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0434\\u043B\\u044F \\u0444\\u043E\\u0440\\u043C\\u044B: \").concat(err.message):\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0434\\u043B\\u044F \\u0444\\u043E\\u0440\\u043C\\u044B: \".concat(err.message));console.error('Fetch dropdown data error:',err);}},[]);// Убраны зависимости, так как они не нужны\nuseEffect(()=>{fetchOperations(currentPage);},[currentPage,fetchOperations]);useEffect(()=>{fetchDropdownData();},[fetchDropdownData]);const handleInputChange=e=>{const{name,value}=e.target;setNewOperation(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const handleSubmit=async e=>{e.preventDefault();setFormLoading(true);setFormError('');if(!newOperation.client_id||!newOperation.currency_id||!newOperation.amount){setFormError('Все поля обязательны.');setFormLoading(false);return;}const amount=parseFloat(newOperation.amount);if(amount<=0){setFormError('Сумма должна быть больше нуля.');setFormLoading(false);return;}if(amount>parseFloat(operationLimits.single_operation_amount)){setFormError(\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438 \\u043F\\u0440\\u0435\\u0432\\u044B\\u0448\\u0430\\u0435\\u0442 \\u043B\\u0438\\u043C\\u0438\\u0442 \".concat(operationLimits.single_operation_amount));setFormLoading(false);return;}try{const payload={client_id:parseInt(newOperation.client_id),operation_type:newOperation.operation_type,currency_id:parseInt(newOperation.currency_id),amount:newOperation.amount.toString(),// Отправляем как строку\ndaily_currency_volume:operationLimits.daily_currency_volume,single_operation_amount:operationLimits.single_operation_amount};console.log('Sending operation payload:',payload);const response=await fetch('http://localhost:8080/api/v1/operations',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!response.ok){let message=\"Network response was not ok (\".concat(response.status,\")\");try{const errData=await response.json();message=errData.message||message;}catch(jsonErr){console.error('Error parsing error response:',jsonErr);}if(message.includes('Daily limit')){setFormError('Превышен дневной лимит по валюте. Попробуйте завтра или уменьшите сумму.');}else if(message.includes('Single operation')){setFormError('Сумма операции превышает допустимый лимит.');}else{setFormError('Ошибка создания операции: '+message);}throw new Error(message);}setNewOperation(prev=>_objectSpread(_objectSpread({},prev),{},{amount:''}));fetchOperations(currentPage);}catch(err){console.error('Error creating operation:',err);}finally{setFormLoading(false);}};const formatDecimal=decimalStr=>{if(!decimalStr)return'N/A';const num=parseFloat(decimalStr);return isNaN(num)?decimalStr:num.toFixed(2);};const formatRate=rateStr=>{if(!rateStr)return'N/A';const num=parseFloat(rateStr);return isNaN(num)?rateStr:num.toFixed(4);};const formatDate=dateTimeStr=>{if(!dateTimeStr)return'Не указано';try{if(typeof dateTimeStr==='object'&&dateTimeStr!==null){if(dateTimeStr.Time){dateTimeStr=dateTimeStr.Time;}else if(dateTimeStr.Valid===false){return'Не указано';}else{dateTimeStr=String(dateTimeStr);}}if(typeof dateTimeStr==='string'){const isoRegex=/^(\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2})(\\.\\d+)?([+-]\\d{2}:\\d{2}|Z)?$/;const match=dateTimeStr.match(isoRegex);if(match){const date=new Date(dateTimeStr);return date.toLocaleString('ru-RU');}const dateMatch=dateTimeStr.match(/(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})/);if(dateMatch){const cleanedDate=dateMatch[1].replace(' ','T');const date=new Date(cleanedDate);if(!isNaN(date.getTime())){return date.toLocaleString('ru-RU');}}}const date=new Date(dateTimeStr);if(!isNaN(date.getTime())){return date.toLocaleString('ru-RU');}return'Некорректная дата';}catch(error){console.error('Ошибка обработки даты:',error);return'Ошибка даты';}};const handleViewOperation=operationId=>{// Функция просмотра операции\nconsole.log('Просмотр операции:',operationId);// Здесь можно добавить логику для открытия модального окна с деталями операции\n};const handleCancelOperation=async operationId=>{// Функция отмены операции\ntry{console.log('Отмена операции:',operationId);const response=await fetch(\"http://localhost:8080/api/v1/operations/\".concat(operationId,\"/cancel\"),{method:'PATCH',headers:{'Content-Type':'application/json'}});if(!response.ok){const errData=await response.json();throw new Error(errData.message||\"Failed to cancel operation (\".concat(response.status,\")\"));}// Обновляем список операций после отмены\nfetchOperations(currentPage);}catch(err){setError('Ошибка отмены операции: '+err.message);console.error('Cancel operation error:',err);}};const sellOperations=operations.filter(op=>op.operation_type==='CLIENT_SELLS_TO_EXCHANGE');const buyOperations=operations.filter(op=>op.operation_type==='CLIENT_BUYS_FROM_EXCHANGE');const totalVolume=operations.reduce((sum,op)=>sum+parseFloat(op.amount_rub||0),0);return/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"\\uD83D\\uDCB8 \\u041E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438 \\u043E\\u0431\\u043C\\u0435\\u043D\\u0430\"}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"alert-icon\",children:\"\\u26A0\\uFE0F\"}),error]}),/*#__PURE__*/_jsxs(\"div\",{className:\"operation-form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u2795 \\u041D\\u043E\\u0432\\u0430\\u044F \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u044F\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"operation-form\",children:[formError&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"alert-icon\",children:\"\\u26A0\\uFE0F\"}),formError]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"client_id\",children:\"\\uD83D\\uDC64 \\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"client_id\",name:\"client_id\",value:newOperation.client_id,onChange:handleInputChange,required:true,className:\"form-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- \\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u043B\\u0438\\u0435\\u043D\\u0442\\u0430 --\"}),clients.map(client=>/*#__PURE__*/_jsxs(\"option\",{value:client.id,children:[client.full_name,\" (ID: \",client.id,\")\"]},client.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"operation_type\",children:\"\\uD83D\\uDD04 \\u0422\\u0438\\u043F \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"operation_type\",name:\"operation_type\",value:newOperation.operation_type,onChange:handleInputChange,className:\"form-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"CLIENT_SELLS_TO_EXCHANGE\",children:\"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442 \\u043F\\u0440\\u043E\\u0434\\u0430\\u0451\\u0442 \\u0432\\u0430\\u043B\\u044E\\u0442\\u0443 (\\u043F\\u043E\\u043A\\u0443\\u043F\\u0430\\u0435\\u0442 \\u0440\\u0443\\u0431\\u043B\\u0438)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"CLIENT_BUYS_FROM_EXCHANGE\",children:\"\\u041A\\u043B\\u0438\\u0435\\u043D\\u0442 \\u043F\\u043E\\u043A\\u0443\\u043F\\u0430\\u0435\\u0442 \\u0432\\u0430\\u043B\\u044E\\u0442\\u0443 (\\u043F\\u0440\\u043E\\u0434\\u0430\\u0451\\u0442 \\u0440\\u0443\\u0431\\u043B\\u0438)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"currency_id\",children:\"\\uD83D\\uDCB1 \\u0412\\u0430\\u043B\\u044E\\u0442\\u0430\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"currency_id\",name:\"currency_id\",value:newOperation.currency_id,onChange:handleInputChange,required:true,className:\"form-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- \\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0432\\u0430\\u043B\\u044E\\u0442\\u0443 --\"}),currencies.map(curr=>/*#__PURE__*/_jsxs(\"option\",{value:curr.id,children:[curr.code,\" (\",curr.name,\")\"]},curr.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"amount\",children:[\"\\uD83D\\uDCB0 \",newOperation.operation_type==='CLIENT_SELLS_TO_EXCHANGE'?'Сумма валюты (продажа)':'Сумма рублей (покупка)']}),/*#__PURE__*/_jsx(\"input\",{id:\"amount\",type:\"number\",step:\"0.01\",name:\"amount\",value:newOperation.amount,onChange:handleInputChange,required:true,className:\"form-input\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0443\\u043C\\u043C\\u0443...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"limits-info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"limits-title\",children:\"\\uD83D\\uDCCA \\u041E\\u0433\\u0440\\u0430\\u043D\\u0438\\u0447\\u0435\\u043D\\u0438\\u044F \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0439\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"limits-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"limit-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"limit-icon\",children:\"\\uD83D\\uDCC8\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"limit-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"limit-label\",children:\"\\u041B\\u0438\\u043C\\u0438\\u0442 \\u043E\\u0434\\u043D\\u043E\\u0439 \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"limit-value\",children:[formatDecimal(operationLimits.single_operation_amount),\" \\u20BD\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"limit-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"limit-icon\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"limit-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"limit-label\",children:\"\\u0414\\u043D\\u0435\\u0432\\u043D\\u043E\\u0439 \\u043B\\u0438\\u043C\\u0438\\u0442 \\u043F\\u043E \\u0432\\u0430\\u043B\\u044E\\u0442\\u0435\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"limit-value\",children:[formatDecimal(operationLimits.daily_currency_volume),\" \\u20BD\"]})]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:formLoading,className:\"btn-primary\",children:formLoading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"loader\"}),\"\\u041E\\u0431\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0430...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCB8\"}),\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u044E\"]})})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"operations-list-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\uD83D\\uDCCB \\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0439\"}),loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loader\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0439...\"})]}),!loading&&operations.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCB8\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041D\\u0435\\u0442 \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0439\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0430\\u0447\\u043D\\u0438\\u0442\\u0435 \\u0441 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u044F \\u043F\\u0435\\u0440\\u0432\\u043E\\u0439 \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438 \\u043E\\u0431\\u043C\\u0435\\u043D\\u0430 \\u0432\\u0430\\u043B\\u044E\\u0442\"})]}),!loading&&operations.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"operations-table\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDD22 ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDD04 \\u0422\\u0438\\u043F\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDC64 \\u041A\\u043B\\u0438\\u0435\\u043D\\u0442\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDCB1 \\u0418\\u0437 \\u0432\\u0430\\u043B\\u044E\\u0442\\u044B\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDCB0 \\u0412 \\u0432\\u0430\\u043B\\u044E\\u0442\\u0443\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDCB8 \\u0421\\u0443\\u043C\\u043C\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDCCA \\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uD83D\\uDCC5 \\u0414\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u2699\\uFE0F \\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:operations.map(operation=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"operation-id\",children:[\"#\",operation.id]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"operation-type \".concat(operation.operation_type),children:operation.operation_type==='buy'?'📈 Покупка':'📉 Продажа'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"client-name\",children:operation.client_name||'Неизвестен'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"currency-from\",children:operation.from_currency})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"currency-to\",children:operation.to_currency})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"amount\",children:parseFloat(operation.amount).toFixed(2)})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"status \".concat(operation.status),children:operation.status==='completed'?'Завершена':operation.status==='pending'?'В процессе':'Отменена'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"operation-date\",children:new Date(operation.created_at).toLocaleDateString()})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleViewOperation(operation.id),className:\"btn-view\",title:\"\\u041F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440 \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438\",children:\"\\uD83D\\uDC41\\uFE0F\"}),operation.status==='pending'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCancelOperation(operation.id),className:\"btn-cancel\",title:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043E\\u043F\\u0435\\u0440\\u0430\\u0446\\u0438\\u044E\",children:\"\\u274C\"})]})})]},operation.id))})]})}),!loading&&operations.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"pagination-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(p=>Math.max(1,p-1)),disabled:currentPage===1||loading,className:\"pagination-btn\",children:\"\\u2190 \\u041F\\u0440\\u0435\\u0434\\u044B\\u0434\\u0443\\u0449\\u0430\\u044F\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"page-info\",children:[\"\\u0421\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0430 \",currentPage]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(p=>p+1),disabled:operations.length<pageSize||loading,className:\"pagination-btn\",children:\"\\u0421\\u043B\\u0435\\u0434\\u0443\\u044E\\u0449\\u0430\\u044F \\u2192\"})]})})]})]})});};export default OperationsPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","OperationsPage","operations","setOperations","clients","setClients","currencies","setCurrencies","newOperation","setNewOperation","client_id","operation_type","currency_id","amount","loading","setLoading","formLoading","setFormLoading","error","setError","formError","setFormError","currentPage","setCurrentPage","pageSize","operationLimits","setOperationLimits","saved","localStorage","getItem","_parsed$find","_parsed$find2","parsed","JSON","parse","daily_currency_volume","find","l","limit_name","limit_value","single_operation_amount","e","console","fetchOperations","page","response","fetch","concat","ok","errData","json","Error","message","status","data","err","downloadReceipt","operationId","blob","url","window","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","prev","openReceipt","reference","receiptUrl","open","fetchDropdownData","_clientsData$data","_currenciesData$data","clientsRes","currenciesRes","Promise","all","clientsData","length","_objectSpread","id","toString","currenciesData","handleInputChange","name","value","target","handleSubmit","preventDefault","parseFloat","payload","parseInt","log","method","headers","stringify","jsonErr","includes","formatDecimal","decimalStr","num","isNaN","toFixed","formatRate","rateStr","formatDate","dateTimeStr","Time","Valid","String","isoRegex","match","date","Date","toLocaleString","dateMatch","cleanedDate","replace","getTime","handleViewOperation","handleCancelOperation","sellOperations","filter","op","buyOperations","totalVolume","reduce","sum","amount_rub","className","children","onSubmit","htmlFor","onChange","required","map","client","full_name","curr","code","type","step","placeholder","disabled","operation","client_name","from_currency","to_currency","created_at","toLocaleDateString","onClick","title","p","Math","max"],"sources":["/Users/qntsnc/GolandProjects/exchange-point/frontend/src/pages/OperationsPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport './OperationsPage.css';\n\nconst OperationsPage = () => {\n  const [operations, setOperations] = useState([]);\n  const [clients, setClients] = useState([]);\n  const [currencies, setCurrencies] = useState([]);\n  const [newOperation, setNewOperation] = useState({\n    client_id: '',\n    operation_type: 'CLIENT_SELLS_TO_EXCHANGE',\n    currency_id: '',\n    amount: '',\n  });\n  const [loading, setLoading] = useState(false);\n  const [formLoading, setFormLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [formError, setFormError] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const pageSize = 10;\n\n  // Загружаем лимиты из localStorage или используем значения по умолчанию\n  const [operationLimits, setOperationLimits] = useState(() => {\n    const saved = localStorage.getItem('operationLimits');\n    if (saved) {\n      try {\n        const parsed = JSON.parse(saved);\n        return {\n          daily_currency_volume: parsed.find(l => l.limit_name === 'daily_currency_volume')?.limit_value || '5000.0',\n          single_operation_amount: parsed.find(l => l.limit_name === 'single_operation_amount')?.limit_value || '1000.0',\n        };\n      } catch (e) {\n        console.error('Error parsing operationLimits from localStorage:', e);\n      }\n    }\n    return {\n      daily_currency_volume: '5000.0',\n      single_operation_amount: '1000.0',\n    };\n  });\n\n  const fetchOperations = useCallback(async (page) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(`http://localhost:8080/api/v1/operations?page=${page}&pageSize=${pageSize}`);\n      if (!response.ok) {\n        const errData = await response.json();\n        throw new Error(errData.message || `Failed to fetch operations (${response.status})`);\n      }\n      const data = await response.json();\n      setOperations(data.data || []);\n    } catch (err) {\n      setError('Ошибка загрузки операций: ' + err.message);\n      console.error('Fetch operations error:', err);\n      setOperations([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [pageSize]);\n\n  const downloadReceipt = async (operationId) => {\n    try {\n      const response = await fetch(`http://localhost:8080/api/v1/operations/${operationId}/receipt`);\n      if (!response.ok) {\n        throw new Error(`Failed to download receipt (${response.status})`);\n      }\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `receipt_${operationId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      console.error('Error downloading receipt:', err);\n      setError(prev => prev ? `${prev}; Ошибка скачивания чека: ${err.message}` : `Ошибка скачивания чека: ${err.message}`);\n    }\n  };\n\n  const openReceipt = (reference) => {\n    const receiptUrl = `http://localhost:8080/api/v1/receipts/${reference}`;\n    window.open(receiptUrl, '_blank');\n  };\n\n  const fetchDropdownData = useCallback(async () => {\n    try {\n      const [clientsRes, currenciesRes] = await Promise.all([\n        fetch('http://localhost:8080/api/v1/clients'),\n        fetch('http://localhost:8080/api/v1/currencies')\n      ]);\n\n      if (!clientsRes.ok) throw new Error('Failed to fetch clients for dropdown');\n      const clientsData = await clientsRes.json();\n      setClients(clientsData.data || []);\n      if (clientsData.data?.length > 0 && !newOperation.client_id) {\n        setNewOperation(prev => ({ ...prev, client_id: clientsData.data[0].id.toString() }));\n      }\n\n      if (!currenciesRes.ok) throw new Error('Failed to fetch currencies for dropdown');\n      const currenciesData = await currenciesRes.json();\n      setCurrencies(currenciesData.data || []);\n      if (currenciesData.data?.length > 0 && !newOperation.currency_id) {\n        setNewOperation(prev => ({ ...prev, currency_id: currenciesData.data[0].id.toString() }));\n      }\n    } catch (err) {\n      setError(prev => prev ? `${prev}; Ошибка загрузки данных для формы: ${err.message}` : `Ошибка загрузки данных для формы: ${err.message}`);\n      console.error('Fetch dropdown data error:', err);\n    }\n  }, []); // Убраны зависимости, так как они не нужны\n\n  useEffect(() => {\n    fetchOperations(currentPage);\n  }, [currentPage, fetchOperations]);\n\n  useEffect(() => {\n    fetchDropdownData();\n  }, [fetchDropdownData]);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setNewOperation(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setFormLoading(true);\n    setFormError('');\n\n    if (!newOperation.client_id || !newOperation.currency_id || !newOperation.amount) {\n      setFormError('Все поля обязательны.');\n      setFormLoading(false);\n      return;\n    }\n    const amount = parseFloat(newOperation.amount);\n    if (amount <= 0) {\n      setFormError('Сумма должна быть больше нуля.');\n      setFormLoading(false);\n      return;\n    }\n    if (amount > parseFloat(operationLimits.single_operation_amount)) {\n      setFormError(`Сумма операции превышает лимит ${operationLimits.single_operation_amount}`);\n      setFormLoading(false);\n      return;\n    }\n\n    try {\n      const payload = {\n        client_id: parseInt(newOperation.client_id),\n        operation_type: newOperation.operation_type,\n        currency_id: parseInt(newOperation.currency_id),\n        amount: newOperation.amount.toString(), // Отправляем как строку\n        daily_currency_volume: operationLimits.daily_currency_volume,\n        single_operation_amount: operationLimits.single_operation_amount,\n      };\n      console.log('Sending operation payload:', payload);\n      const response = await fetch('http://localhost:8080/api/v1/operations', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n      if (!response.ok) {\n        let message = `Network response was not ok (${response.status})`;\n        try {\n          const errData = await response.json();\n          message = errData.message || message;\n        } catch (jsonErr) {\n          console.error('Error parsing error response:', jsonErr);\n        }\n        if (message.includes('Daily limit')) {\n          setFormError('Превышен дневной лимит по валюте. Попробуйте завтра или уменьшите сумму.');\n        } else if (message.includes('Single operation')) {\n          setFormError('Сумма операции превышает допустимый лимит.');\n        } else {\n          setFormError('Ошибка создания операции: ' + message);\n        }\n        throw new Error(message);\n      }\n      setNewOperation(prev => ({ ...prev, amount: '' }));\n      fetchOperations(currentPage);\n    } catch (err) {\n      console.error('Error creating operation:', err);\n    } finally {\n      setFormLoading(false);\n    }\n  };\n\n  const formatDecimal = (decimalStr) => {\n    if (!decimalStr) return 'N/A';\n    const num = parseFloat(decimalStr);\n    return isNaN(num) ? decimalStr : num.toFixed(2);\n  };\n\n  const formatRate = (rateStr) => {\n    if (!rateStr) return 'N/A';\n    const num = parseFloat(rateStr);\n    return isNaN(num) ? rateStr : num.toFixed(4);\n  };\n\n  const formatDate = (dateTimeStr) => {\n    if (!dateTimeStr) return 'Не указано';\n    try {\n      if (typeof dateTimeStr === 'object' && dateTimeStr !== null) {\n        if (dateTimeStr.Time) {\n          dateTimeStr = dateTimeStr.Time;\n        } else if (dateTimeStr.Valid === false) {\n          return 'Не указано';\n        } else {\n          dateTimeStr = String(dateTimeStr);\n        }\n      }\n      if (typeof dateTimeStr === 'string') {\n        const isoRegex = /^(\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2})(\\.\\d+)?([+-]\\d{2}:\\d{2}|Z)?$/;\n        const match = dateTimeStr.match(isoRegex);\n        if (match) {\n          const date = new Date(dateTimeStr);\n          return date.toLocaleString('ru-RU');\n        }\n        const dateMatch = dateTimeStr.match(/(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})/);\n        if (dateMatch) {\n          const cleanedDate = dateMatch[1].replace(' ', 'T');\n          const date = new Date(cleanedDate);\n          if (!isNaN(date.getTime())) {\n            return date.toLocaleString('ru-RU');\n          }\n        }\n      }\n      const date = new Date(dateTimeStr);\n      if (!isNaN(date.getTime())) {\n        return date.toLocaleString('ru-RU');\n      }\n      return 'Некорректная дата';\n    } catch (error) {\n      console.error('Ошибка обработки даты:', error);\n      return 'Ошибка даты';\n    }\n  };\n\n  const handleViewOperation = (operationId) => {\n    // Функция просмотра операции\n    console.log('Просмотр операции:', operationId);\n    // Здесь можно добавить логику для открытия модального окна с деталями операции\n  };\n\n  const handleCancelOperation = async (operationId) => {\n    // Функция отмены операции\n    try {\n      console.log('Отмена операции:', operationId);\n      const response = await fetch(`http://localhost:8080/api/v1/operations/${operationId}/cancel`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n      });\n      if (!response.ok) {\n        const errData = await response.json();\n        throw new Error(errData.message || `Failed to cancel operation (${response.status})`);\n      }\n      // Обновляем список операций после отмены\n      fetchOperations(currentPage);\n    } catch (err) {\n      setError('Ошибка отмены операции: ' + err.message);\n      console.error('Cancel operation error:', err);\n    }\n  };\n\n  const sellOperations = operations.filter(op => op.operation_type === 'CLIENT_SELLS_TO_EXCHANGE');\n  const buyOperations = operations.filter(op => op.operation_type === 'CLIENT_BUYS_FROM_EXCHANGE');\n  const totalVolume = operations.reduce((sum, op) => sum + parseFloat(op.amount_rub || 0), 0);\n\n  return (\n    <div className=\"main-content\">\n      <div className=\"container\">\n        <h1 className=\"page-title\">💸 Операции обмена</h1>\n\n        {/* Общие ошибки */}\n        {error && (\n          <div className=\"alert alert-error\">\n            <span className=\"alert-icon\">⚠️</span>\n            {error}\n          </div>\n        )}\n\n        {/* Форма создания операции */}\n        <div className=\"operation-form-section\">\n          <h2 className=\"section-title\">➕ Новая операция</h2>\n          \n          <form onSubmit={handleSubmit} className=\"operation-form\">\n            {formError && (\n              <div className=\"alert alert-error\">\n                <span className=\"alert-icon\">⚠️</span>\n                {formError}\n              </div>\n            )}\n\n            <div className=\"form-grid\">\n              <div className=\"form-field\">\n                <label htmlFor=\"client_id\">👤 Клиент</label>\n                <select\n                  id=\"client_id\"\n                  name=\"client_id\"\n                  value={newOperation.client_id}\n                  onChange={handleInputChange}\n                  required\n                  className=\"form-select\"\n                >\n                  <option value=\"\">-- Выберите клиента --</option>\n                  {clients.map(client => (\n                    <option key={client.id} value={client.id}>\n                      {client.full_name} (ID: {client.id})\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"form-field\">\n                <label htmlFor=\"operation_type\">🔄 Тип операции</label>\n                <select\n                  id=\"operation_type\"\n                  name=\"operation_type\"\n                  value={newOperation.operation_type}\n                  onChange={handleInputChange}\n                  className=\"form-select\"\n                >\n                  <option value=\"CLIENT_SELLS_TO_EXCHANGE\">Клиент продаёт валюту (покупает рубли)</option>\n                  <option value=\"CLIENT_BUYS_FROM_EXCHANGE\">Клиент покупает валюту (продаёт рубли)</option>\n                </select>\n              </div>\n\n              <div className=\"form-field\">\n                <label htmlFor=\"currency_id\">💱 Валюта</label>\n                <select\n                  id=\"currency_id\"\n                  name=\"currency_id\"\n                  value={newOperation.currency_id}\n                  onChange={handleInputChange}\n                  required\n                  className=\"form-select\"\n                >\n                  <option value=\"\">-- Выберите валюту --</option>\n                  {currencies.map(curr => (\n                    <option key={curr.id} value={curr.id}>\n                      {curr.code} ({curr.name})\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"form-field\">\n                <label htmlFor=\"amount\">\n                  💰 {newOperation.operation_type === 'CLIENT_SELLS_TO_EXCHANGE'\n                    ? 'Сумма валюты (продажа)'\n                    : 'Сумма рублей (покупка)'}\n                </label>\n                <input\n                  id=\"amount\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  name=\"amount\"\n                  value={newOperation.amount}\n                  onChange={handleInputChange}\n                  required\n                  className=\"form-input\"\n                  placeholder=\"Введите сумму...\"\n                />\n              </div>\n            </div>\n\n            <div className=\"limits-info\">\n              <h3 className=\"limits-title\">📊 Ограничения операций</h3>\n              <div className=\"limits-grid\">\n                <div className=\"limit-item\">\n                  <div className=\"limit-icon\">📈</div>\n                  <div className=\"limit-content\">\n                    <div className=\"limit-label\">Лимит одной операции</div>\n                    <div className=\"limit-value\">{formatDecimal(operationLimits.single_operation_amount)} ₽</div>\n                  </div>\n                </div>\n                <div className=\"limit-item\">\n                  <div className=\"limit-icon\">📊</div>\n                  <div className=\"limit-content\">\n                    <div className=\"limit-label\">Дневной лимит по валюте</div>\n                    <div className=\"limit-value\">{formatDecimal(operationLimits.daily_currency_volume)} ₽</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"form-actions\">\n              <button\n                type=\"submit\"\n                disabled={formLoading}\n                className=\"btn-primary\"\n              >\n                {formLoading ? (\n                  <>\n                    <div className=\"loader\"></div>\n                    Обработка...\n                  </>\n                ) : (\n                  <>\n                    <span>💸</span>\n                    Создать операцию\n                  </>\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n\n        {/* История операций */}\n        <div className=\"operations-list-section\">\n          <h2 className=\"section-title\">📋 История операций</h2>\n          \n          {loading && (\n            <div className=\"loading-state\">\n              <div className=\"loader\"></div>\n              <p>Загрузка операций...</p>\n            </div>\n          )}\n\n          {!loading && operations.length === 0 && (\n            <div className=\"empty-state\">\n              <div className=\"empty-icon\">💸</div>\n              <h3>Нет операций</h3>\n              <p>Начните с создания первой операции обмена валют</p>\n            </div>\n          )}\n\n          {!loading && operations.length > 0 && (\n            <div className=\"operations-table\">\n              <table>\n                <thead>\n                  <tr>\n                    <th>🔢 ID</th>\n                    <th>🔄 Тип</th>\n                    <th>👤 Клиент</th>\n                    <th>💱 Из валюты</th>\n                    <th>💰 В валюту</th>\n                    <th>💸 Сумма</th>\n                    <th>📊 Статус</th>\n                    <th>📅 Дата</th>\n                    <th>⚙️ Действия</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {operations.map(operation => (\n                    <tr key={operation.id}>\n                      <td>\n                        <span className=\"operation-id\">#{operation.id}</span>\n                      </td>\n                      <td>\n                        <span className={`operation-type ${operation.operation_type}`}>\n                          {operation.operation_type === 'buy' ? '📈 Покупка' : '📉 Продажа'}\n                        </span>\n                      </td>\n                      <td>\n                        <span className=\"client-name\">{operation.client_name || 'Неизвестен'}</span>\n                      </td>\n                      <td>\n                        <span className=\"currency-from\">{operation.from_currency}</span>\n                      </td>\n                      <td>\n                        <span className=\"currency-to\">{operation.to_currency}</span>\n                      </td>\n                      <td>\n                        <span className=\"amount\">\n                          {parseFloat(operation.amount).toFixed(2)}\n                        </span>\n                      </td>\n                      <td>\n                        <span className={`status ${operation.status}`}>\n                          {operation.status === 'completed' ? 'Завершена' : \n                           operation.status === 'pending' ? 'В процессе' : 'Отменена'}\n                        </span>\n                      </td>\n                      <td>\n                        <span className=\"operation-date\">\n                          {new Date(operation.created_at).toLocaleDateString()}\n                        </span>\n                      </td>\n                      <td>\n                        <div className=\"action-buttons\">\n                          <button \n                            onClick={() => handleViewOperation(operation.id)}\n                            className=\"btn-view\"\n                            title=\"Просмотр операции\"\n                          >\n                            👁️\n                          </button>\n                          {operation.status === 'pending' && (\n                            <button \n                              onClick={() => handleCancelOperation(operation.id)}\n                              className=\"btn-cancel\"\n                              title=\"Отменить операцию\"\n                            >\n                              ❌\n                            </button>\n                          )}\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n\n          {/* Пагинация */}\n          {!loading && operations.length > 0 && (\n            <div className=\"pagination-section\">\n              <div className=\"pagination\">\n                <button\n                  onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\n                  disabled={currentPage === 1 || loading}\n                  className=\"pagination-btn\"\n                >\n                  ← Предыдущая\n                </button>\n                <span className=\"page-info\">Страница {currentPage}</span>\n                <button\n                  onClick={() => setCurrentPage(p => p + 1)}\n                  disabled={operations.length < pageSize || loading}\n                  className=\"pagination-btn\"\n                >\n                  Следующая →\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default OperationsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}